schema: '2.0'
stages:
  convert_labeled_data:
    cmd: python src/convert_labeled_data.py
    deps:
    - path: data/labeled_data.csv
      hash: md5
      md5: 184ff39f76a05b00639aaf302d729dfd
      size: 152703
    - path: src/convert_labeled_data.py
      hash: md5
      md5: 9ac03685ff26e95717642b3cb0e15f00
      size: 1791
    outs:
    - path: data/annotation_per_row_data.csv
      hash: md5
      md5: 231ed4a0b0334c36c4174ff8c6ef75de
      size: 100890
  fetch_labeled_data:
    cmd: ./src/fetch_data.sh
    deps:
    - path: src/fetch_data.sh
      hash: md5
      md5: b031d3969b674c3d84a4d78d08ca18b5
      size: 239
      isexec: true
    outs:
    - path: data/labeled_data.csv
      hash: md5
      md5: 184ff39f76a05b00639aaf302d729dfd
      size: 152703
  download_audio:
    cmd: python ./src/download_audio.py --target-dir data/audio --annotations-file
      data/annotation_per_row_data.csv
    deps:
    - path: data/annotation_per_row_data.csv
      hash: md5
      md5: 231ed4a0b0334c36c4174ff8c6ef75de
      size: 100890
    - path: src/download_audio.py
      hash: md5
      md5: e30a5245b41ca67141206a1dab1b723c
      size: 1396
    outs:
    - path: data/audio
      hash: md5
      md5: 6beca6e665ebceb8f6e1380bea7262d2.dir
      size: 291748336
      nfiles: 644
  extract_data_quality:
    cmd: python ./src/extract_data_quality.py
    deps:
    - path: data/annotation_per_row_data.csv
      hash: md5
      md5: 231ed4a0b0334c36c4174ff8c6ef75de
      size: 100890
    - path: src/extract_data_quality.py
      hash: md5
      md5: 00b870221932606f650f99d03d300be0
      size: 647
    outs:
    - path: data/data_quality/sample_based_quality.json
      hash: md5
      md5: a0bef49186292a42048579faf78be959
      size: 105
    - path: data/data_quality/samples_per_label.csv
      hash: md5
      md5: 758e20ec31fafeeee898d0d7812aeb66
      size: 75
  cut_in_chunks:
    cmd: python src/cut_in_chunks.py
    deps:
    - path: data/annotation_per_row_data.csv
      hash: md5
      md5: f9a65edaa7ac71df1f01c39549250402
      size: 78085
    - path: src/cut_in_chunks.py
      hash: md5
      md5: 351f5095b6f87abbd640c25a9640420b
      size: 994
    params:
      params.yaml:
        chunk_overlap: 30
        chunk_size: 200
    outs:
    - path: data/chunked_data.csv
      hash: md5
      md5: 208b05c400ac9f50d541a1f05eb40d53
      size: 17128119
  balance_data_set:
    cmd: python src/balance_dataset.py
    deps:
    - path: data/chunked_data.csv
      hash: md5
      md5: 208b05c400ac9f50d541a1f05eb40d53
      size: 17128119
    - path: src/balance_dataset.py
      hash: md5
      md5: f40146df2cfbe074a4402a8d98c95f81
      size: 1184
    outs:
    - path: data/balanced_data.csv
      hash: md5
      md5: 7f431ecef78783885462ab82a0a0c919
      size: 474938
  extract_features:
    cmd: python src/extract_mfcc_features.py
    deps:
    - path: data/audio
      hash: md5
      md5: 6beca6e665ebceb8f6e1380bea7262d2.dir
      size: 291748336
      nfiles: 644
    - path: src/extract_mfcc_features.py
      hash: md5
      md5: 6c026247c2c7b372434361813303efc6
      size: 1988
    params:
      params.yaml:
        feature_extraction:
          n_mfcc: 13
          n_fft: 512
    outs:
    - path: data/mfcc_data/
      hash: md5
      md5: 27098f9d0968a88011f99e629412b1db.dir
      size: 14922816
      nfiles: 644
  train_model:
    cmd: python src/train_xgboost.py
    deps:
    - path: data/balanced_data.h5
      hash: md5
      md5: f9c7b0d926c981b04143ae9e0cc0d894
      size: 7073200
    - path: src/train_xgboost.py
      hash: md5
      md5: a94f24210bcef0f336e549a5ed51ad8e
      size: 2192
    params:
      params.yaml:
        model:
          n_estimators: 25
          max_depth: 6
          learning_rate: 0.1
          random_state: 42
        training:
          test_size: 0.2
    outs:
    - path: models/xgboost_model.json
      hash: md5
      md5: d46c20645b67909c0ca65ff840094b0c
      size: 120549
  draw_data:
    cmd: python src/draw_data.py
    deps:
    - path: data/annotation_per_row_data.csv
      hash: md5
      md5: 231ed4a0b0334c36c4174ff8c6ef75de
      size: 100890
    - path: data/mfcc_data/
      hash: md5
      md5: 27098f9d0968a88011f99e629412b1db.dir
      size: 14922816
      nfiles: 644
    - path: src/draw_data.py
      hash: md5
      md5: c2825032fc3be8685824cdfa4cc60f95
      size: 4064
    params:
      params.yaml:
        chunk_overlap: 30
        chunk_size: 500
        inbalance_ratio: 1.0
    outs:
    - path: data/balanced_data.h5
      hash: md5
      md5: f9c7b0d926c981b04143ae9e0cc0d894
      size: 7073200
